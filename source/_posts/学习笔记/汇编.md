---
title: 汇编
date: 2023-05-05 21:30:42
tags:  
---
gcc -S x.c -o x.s

## x86_64j寄存器
1. %rax 通常存储函数调用的返回结果，也被用在idiv （除法）和imul（乘法）命令中
2. %rsp 堆栈指针寄存器，指向栈顶位置。pop操作通过增大rsp的值实现出栈，push操作通过减小rsp的值实现入栈(栈从高地址向低地址扩展)
3. %rbp ：栈帧指针(栈底寄存器)，标识当前栈帧的起始位置
4. %rdi, %rsi, %rdx, %rcx,%r8, %r9 ：六个寄存器,当args的数量<7依次从左放入,args数量>=7后超过的部分从后往前放入栈中
5. leave 其作用为恢复堆栈指针,相当于
```
movl  %ebp, %rsp
pop1  %ebp
```
6. 每次call一个函数，将调用函数下一条指令入栈，被调函数返回后将取这条指令继续执行,修改指令指针寄存器eip的值，使其指向被调函数的执行位置,把当前的栈底指针压入堆栈，然后把栈底指针移动到当前栈顶，这样就相当于在旧栈上新开辟一个栈，等被调用的函数执行的时候，CPU依次执行栈中的指令，然后再依次出栈，也就是说，当函数执行完毕，再恢复堆栈指针之后，栈顶指针又回到了函数调用的位置
7. 混合显示c语言与汇编
```shell
gcc -o hello -g hello.c //要加上-g 选项
objdump -S hello
```
8. 反汇编