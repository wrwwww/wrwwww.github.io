---
title: 计算机组成原理
date: 2023-05-05 21:30:42
tags:  
---
# 计算机的硬件组成
五大部件 输入设备，输出设备，存储器，运算器，控制器
主机=（cpu=控制器+运算器）+ 主存
计算机主要性能指标
机器字长 数据通路宽度 主存容量 运算速度 
# 数值的表示
整数
浮点数
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670639742503-e35fc398-6d2a-4822-a358-e978d4b26bf4.png#averageHue=%23f7f7f7&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=305&id=u5ec83e2a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=413&originWidth=861&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65413&status=done&style=shadow&taskId=uef3daf7a-b47a-4342-bd9a-10088f50ad3&title=&width=635.8154032726407)
**数据的表示范围 原码 补码**
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670639976554-7f79be83-3ff7-4a5a-9e8c-4a95dd81840c.png#averageHue=%23f7f7f7&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=305&id=u5282d5e4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=413&originWidth=734&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52419&status=done&style=shadow&taskId=u1505ba14-fbf5-4d12-931f-690e75cc662&title=&width=542.0307851360258)

# 指令系统
## 3.1指令格式
### 思维导图
![[指令系统.jpg]]
指令的基本格式是
![](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1665565710375-3f93fbcd-5236-4903-ab53-d061da7e6b9c.jpeg)
 ![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670640240207-8c50abf7-43a0-4e34-b085-d6fb1ad850c8.png#averageHue=%23f2f2f2&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=263&id=ud63cabb4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=356&originWidth=971&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86487&status=done&style=shadow&taskId=u845e7e19-8f2a-48fc-a33d-23d5465e216&title=&width=717.0461748870314)
编制方式：字节，字
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670640768024-7f13b669-edc7-48a6-9f34-179ccd7a0f2a.png#averageHue=%23fafefd&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=168&id=u2a170f39&margin=%5Bobject%20Object%5D&name=image.png&originHeight=228&originWidth=790&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45653&status=done&style=shadow&taskId=uaf41fd05-3698-44ab-ada8-0d8762debfb&title=&width=583.384632503352)

## IEEE754标准的浮点数
| 类型 | 数符 | 阶码 | 尾数 | 总位数 | 偏置值 |
| --- | --- | --- | --- | --- | --- |
| 单精度浮点型 | 1 | 8 | 13 | 31 | 127 |
| 双精度浮点型 | 1 | 11 | 52 | 64 | 1023 |
| 临时浮点数 | 1 | 15 | 64 | 80 | 16383 |

![Screenshot_20221027_203732.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1666874378699-8f66276f-f4a2-491f-a95e-8d6812d26106.png#averageHue=%23f7f7f7&clientId=u0885d815-63db-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u38b16a3f&margin=%5Bobject%20Object%5D&name=Screenshot_20221027_203732.png&originHeight=269&originWidth=743&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15675&status=done&style=shadow&taskId=ud21cc878-db16-460b-ae27-240e2ca7a1a&title=)
将（100.25）转为短浮点数
基本流程：
1. 整数转换，除二取余
2. 小数转换，乘二取整
3. 结果组合
4. 科学记数法
5. 指数偏移
6. 拼接组合
##### 整数转换
100/2=50余0
50/2=25余0
25/2=12余1
12/2=6余0
6/2=3余0
3/2=1余1
1
100转换为（1100100）2
##### 小数取整
0.25*2=0.5取0
0.5*2=1 取 1
0.25转为 （0.01）2 
##### 组合结果
100.25=（1100100.01）2
##### 科学计数法
1100100.01=1.10010001*26
##### 指数偏移
偏移量127+6=133
阶码=133=（10000101）2
##### 拼接组合
数符+阶码+尾数
0  	10000101  10010001
尾数最高位默认隐含一个1
尾数实际是（1.10010001）2
#### 短浮点数到整数
1 10000011 10010010000000000000000
符号位 1 为负数
阶码 10000011  = 131 减去偏移值 127 =4
尾数1.1001001
组合-1.1001001*24
二进制-11001.001=25.125
##### 阶码全零，全一的情况
作为保留作他用，正常取值范围1～254即-126～127
全零表示机器零
全一时候 尾数为0表示正负无穷
#### 数据的机器运算
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670640926068-87d37634-ef59-4f39-9f70-9c6a7d3c29fd.png#averageHue=%23f6f6f6&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=298&id=uc99fea7b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=403&originWidth=830&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56491&status=done&style=shadow&taskId=ud596e95b-c1e0-448a-afe4-ec158ea3c17&title=&width=612.9230949085851)
除法不需要

# 存储系统和结构
**重点**
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648055137-c662e2a1-8522-47bb-a28d-df60d7c516db.png#averageHue=%23eed7d4&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=380&id=uef16f568&margin=%5Bobject%20Object%5D&name=image.png&originHeight=515&originWidth=1080&originalType=binary&ratio=1&rotation=0&showTitle=false&size=114418&status=done&style=shadow&taskId=uea4e5adc-8c0a-4517-be6a-b6bc524d872&title=&width=797.5384849412914)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648077488-bbeedf7f-34bc-4dfb-9b50-eabbbbe55ec9.png#averageHue=%23e6cfcd&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=466&id=u317ace61&margin=%5Bobject%20Object%5D&name=image.png&originHeight=631&originWidth=1149&originalType=binary&ratio=1&rotation=0&showTitle=false&size=168081&status=done&style=shadow&taskId=u4a382775-6ab1-486a-b39d-2a14a78bb72&title=&width=848.4923325903184)

![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648088433-00c41f17-b8fa-4769-b31b-31a740cc93f4.png#averageHue=%23e5cecb&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=478&id=u46b95248&margin=%5Bobject%20Object%5D&name=image.png&originHeight=647&originWidth=1134&originalType=binary&ratio=1&rotation=0&showTitle=false&size=190845&status=done&style=shadow&taskId=u0694b531-6f1d-4cfd-8302-b0710aa1f9c&title=&width=837.415409188356)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648104764-e442ee94-d911-4764-a090-496c787ed8ca.png#averageHue=%23eed8d6&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=419&id=uca23510f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=567&originWidth=1112&originalType=binary&ratio=1&rotation=0&showTitle=false&size=110000&status=done&style=shadow&taskId=ub27c6bad-c942-49f9-adb1-6d49a0a34ac&title=&width=821.1692548654778)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648139089-c102a299-5edd-4bbb-9d0a-ff89670bec83.png#averageHue=%23f5f4f3&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=602&id=ue9f54940&margin=%5Bobject%20Object%5D&name=image.png&originHeight=815&originWidth=1439&originalType=binary&ratio=1&rotation=0&showTitle=false&size=122502&status=done&style=shadow&taskId=u4e1c3982-5628-4382-ae0d-49b33496235&title=&width=1062.6461850282576)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670648197344-c8c568d5-d600-4ec4-8322-0eee42f737bc.png#averageHue=%23efeded&clientId=u52b62175-2924-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=607&id=uc2361fe6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=822&originWidth=663&originalType=binary&ratio=1&rotation=0&showTitle=false&size=119386&status=done&style=shadow&taskId=u246eb774-1a5a-4799-94a3-f1ec5fa1a9b&title=&width=489.6000143667372)
编址方式 1. 字节编址 2. 字编址
**字节编址**以字节数表示存储容量
**字编址**以字的单元数*机器字长表示存储容量
例子：64K*16 这个是字编址，64k个存储单元与机器字长16位
转为字节编址为128K*8 这个8是8位，8位为一个字节，这就是字节编址
##### 1.某8位微型机地址码为18位，若使用4K×4位的RAM芯片组成模块板结构的存储器，试问：
（1）该机所允许的最大主存空间是多少？
（2）若每个模块板为32K×8位，共需几个模块板？
（3）每个模块板内共有几片RAM芯片？
（4）共有多少片RAM？
（5）CPU如何选择各模块板？
218 =262144位=262144/8 b=32768b=
1kb=1024b
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670724588220-1d6b592a-646a-4cfb-b3e7-ec8aae91ed91.png#averageHue=%23eeeeee&clientId=u38b7a52e-dc1f-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=270&id=ua1b2ad25&margin=%5Bobject%20Object%5D&name=image.png&originHeight=366&originWidth=668&originalType=binary&ratio=1&rotation=0&showTitle=true&size=61531&status=done&style=shadow&taskId=u28096fc4-39d8-4f64-bd51-22a7510162a&title=%E4%B8%BB%E5%AD%98%E7%9A%84%E6%9E%84%E6%88%90&width=493.2923221673913 "主存的构成")
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670724600435-6d586353-5f8c-4882-9669-b45d56c5e4ec.png#averageHue=%23f7f7f7&clientId=u38b7a52e-dc1f-4&crop=0&crop=0.0759&crop=1&crop=0.7957&from=paste&height=343&id=u92a222ad&margin=%5Bobject%20Object%5D&name=image.png&originHeight=464&originWidth=440&originalType=binary&ratio=1&rotation=0&showTitle=true&size=45793&status=done&style=shadow&taskId=u0c867578-9eac-4b44-a29d-c834d1b4ecc&title=%E5%AD%98%E5%82%A8%E5%85%83&width=325 "存储元")
mos管上接受到高电平，mos管就导通这时如果给这条线输入高电平，电容两侧就会产生电压，电容就会充电，这就相当于写入了一个二进制位。如果电容有电导通这条线，在这条线上就会读出二进制1，否者为0。这就是最小的存储单位，存储元。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670724595914-7a428815-1b7d-49c6-b6e3-1fbd233c885a.png#averageHue=%23f7f5f5&clientId=u38b7a52e-dc1f-4&crop=0&crop=0&crop=1&crop=0.5409&from=paste&height=268&id=u874c96ca&margin=%5Bobject%20Object%5D&name=image.png&originHeight=363&originWidth=1183&originalType=binary&ratio=1&rotation=0&showTitle=true&size=104002&status=done&style=shadow&taskId=ua3128c8b-fd64-4a91-a4d4-fdd67f24993&title=%E5%AD%98%E5%82%A8%E5%8D%95%E5%85%83&width=874 "存储单元")
这是一个存储单元，由多个存储元构成，期中红色的是自选线，绿色的是数据线，片选线导通就可以对数据进行读写，而具体的是读是写由数据线来控制。期中数据线有8条表示一次可以读取8个比特位，这就与机器字长有关系了。多个存储单元就构成存储体。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670724592572-e28044b5-8f73-4b4d-a79b-a752879a856a.png#averageHue=%23eeeeee&clientId=u38b7a52e-dc1f-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=275&id=u8c458cf2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=372&originWidth=718&originalType=binary&ratio=1&rotation=0&showTitle=true&size=46286&status=done&style=shadow&taskId=u74244fed-77d6-4cff-972d-6db6c00ae83&title=%E5%AD%98%E5%82%A8%E4%BD%93&width=530.2154001739326 "存储体")
选择哪个存储单元由地址寄存器来确定，而数据读取写入最后由数据寄存器来负责。
![9eb83e6ec9d7c4dd0879275eac0d746.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670752287797-6581ffe8-7ea4-45da-8838-dd135bc2191f.png#averageHue=%23f0ecec&clientId=u38b7a52e-dc1f-4&crop=0&crop=0&crop=1&crop=0.9574&from=drop&height=1080&id=u04fe5801&margin=%5Bobject%20Object%5D&name=9eb83e6ec9d7c4dd0879275eac0d746.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=818476&status=done&style=shadow&taskId=uef4440ad-dbd9-4540-a541-38171cb2de6&title=&width=1920)
地址寄存器接收来自地址总线的地址，通过地址译码器选择指定的存储单元。
MAR地址寄存器有n位，则能映射2n个存储单元，图中的机器存储大小可以表示为：
23 * 8bit = 23 * 1B = 8 * 1B = 8B
其中23为存储单元的大小，数量 8bit 为一个存储单元（存储字/机器字长）大小
![13311c99-2ed4-410f-99f8-9d5eb53e1b44.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670753529349-4d7edd60-7a45-44d8-9d1a-7988d56a3135.png#averageHue=%23f0ecec&clientId=u38b7a52e-dc1f-4&crop=0.0211&crop=0.015&crop=0.9817&crop=0.9349&from=drop&height=1037&id=u420f19ec&margin=%5Bobject%20Object%5D&name=13311c99-2ed4-410f-99f8-9d5eb53e1b44.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=949557&status=done&style=shadow&taskId=uaf979647-db83-4f23-8e0e-0620a48792f&title=&width=1844)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670753832191-bf142f93-6c11-456a-a1ed-2c6965d3adaa.png#averageHue=%23ede1d9&clientId=u38b7a52e-dc1f-4&crop=0.0229&crop=0&crop=1&crop=1&from=paste&height=229&id=uf1c01d68&margin=%5Bobject%20Object%5D&name=image.png&originHeight=317&originWidth=711&originalType=binary&ratio=1&rotation=0&showTitle=false&size=141155&status=done&style=shadow&taskId=u82e49bf0-0c91-45a1-a588-615909e0c1a&title=&width=513)
在译码器，MAR,MDR上都连接着控制电路，控制电路当电信号稳定后才可以进行下一步。
控制电路的输入片选线低电平有效，只有片选线为低电平时候这个控制电路才有效，读写电路是控制是进行读操作还是写操作。读写控制线有两条线的有一条线的。
![cc150a47e9d83db39e9c3029a8be807.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670754163624-59553be5-e961-4160-b1bb-77c5029891a8.png#averageHue=%23ede8e7&clientId=u38b7a52e-dc1f-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u34cc0fab&margin=%5Bobject%20Object%5D&name=cc150a47e9d83db39e9c3029a8be807.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=true&size=1294833&status=done&style=shadow&taskId=u3ddd1ff5-42d4-4fa3-909c-b09301177db&title=%E5%86%85%E5%AD%98%E6%9D%A1%E5%8F%AF%E8%83%BD%E6%9C%89%E5%A4%9A%E4%B8%AA%E5%88%86%E7%89%87%EF%BC%8C%E9%80%9A%E8%BF%87%E7%89%87%E9%80%89%E7%BA%BF%E6%9D%A5%E9%80%89%E6%8B%A9%E9%9C%80%E8%A6%81%E7%9A%84%E9%82%A3%E4%B8%80%E6%9D%A1 "内存条可能有多个分片，通过片选线来选择需要的那一条")
如果分析一个芯片至少多少个引脚：有vcc，GND，地址总线，数据总线的条数，控制电路的片选线，读写控制线。

---

**1. 已知某64位机主存采用半导体存储器，其地址码为26位，若使用256K×16位的DRAM芯片组成该机所允许的最大主存空间，并选用模块板结构形式。**（1） 每个模块板为1024K×64位，共需几个模块板？
（2） 每个模块板内共有多少DRAM芯片?
（3）主存共需多少DRAM芯片? CPU如何选择各模块板？
地址码26位，64位的机器，机器字长64
机器内存容量：226*64bit = 4GB
1024K=1024*1024=210*210
每个模块板主存容量：1024K×64bit=220*64bit
芯片：256K×16=218×16bit

1. 226*64bit/220*64bit=226-20 =26=**64 **
2. 220*64bit/218×16bit=24=**16**
3. 主存共需DRAM芯片为：16×64=1024 (片)

每个模块板有16片DRAM芯片，构成容量为1024K×64位，需20根地址线(A19~A0)完成模块板内存储单元寻址。一共有64块模块板，采用6根高位地址线(A25~A20)，通过6：64译码器译码产生片选信号对各模块板进行选择。
位扩展 4片256K×16—>256K×64
字扩展：4组（256K×64）à1024K×64位

## 主存储器的性能指标
![思维导图.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670913171682-5aaf666e-9379-4b7a-9b65-ae61ce736de3.png#averageHue=%230c0b08&clientId=u4b755130-ef81-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u04ae261e&margin=%5Bobject%20Object%5D&name=%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE.png&originHeight=828&originWidth=1770&originalType=binary&ratio=1&rotation=0&showTitle=true&size=197607&status=done&style=shadow&taskId=ub7d1e487-ebf5-4326-8ab6-db7f8c1270d&title=%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE "思维导图")
## 半导体随机存储器（RAM）
### DRAM与SRAM的对比
![d4887fa7b61908e871f04ae0c858bc8.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670839412544-cd9324c0-16f2-4d7e-bda2-337f9a642a7f.png#averageHue=%23ede1de&clientId=u3f6f33ec-d2e9-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=ud1a7658b&margin=%5Bobject%20Object%5D&name=d4887fa7b61908e871f04ae0c858bc8.png&originHeight=625&originWidth=1148&originalType=binary&ratio=1&rotation=0&showTitle=true&size=366739&status=done&style=shadow&taskId=ua2728dec-bb48-4b96-991d-0acb7c57b3d&title=sram%E4%B8%8Edram%E7%9A%84%E5%AF%B9%E6%AF%94 "sram与dram的对比")
sram采用双稳态可以非破坏性读写，而dram是破坏性读写，需要恢复状态，而且电容里的电会在2ms后消失，所以存储器需要定时刷新。对于上面说的译码器连接出来的片选线，如果一个单元一条线会浪费资源，对于220也就是1M大小的存储单元需要220条线去选择，而如果分成行列式，只需要行，列各自1024条就好，一个存储单元由一个行一个列来选择，大大降低了布线的要求。
#### 动态RAM的刷新
![a5b5be8a8338b5e74a6075b76a78bdb.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670840378913-744327ce-825b-4d5f-8943-1517ee8609e5.png#averageHue=%23ececeb&clientId=u3f6f33ec-d2e9-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=ub48d0ea6&margin=%5Bobject%20Object%5D&name=a5b5be8a8338b5e74a6075b76a78bdb.png&originHeight=614&originWidth=1095&originalType=binary&ratio=1&rotation=0&showTitle=false&size=306704&status=done&style=shadow&taskId=ua9d0ec4c-0f6e-4f14-b75a-51698622313&title=)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670840467938-be1ace3c-862c-413f-b992-0f4fbbd4849b.png#averageHue=%23edeceb&clientId=u3f6f33ec-d2e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=520&id=u30ab716c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=704&originWidth=1267&originalType=binary&ratio=1&rotation=0&showTitle=true&size=596658&status=done&style=shadow&taskId=u6f29b4a9-211a-4c37-a2f2-a4aea771548&title=%E5%88%B7%E6%96%B0&width=935.6307966857557 "刷新")
### RAM芯片分析
#### 地址译码方式
##### 单译码
即自选法，上面提到的单地址线的译码方式
![4ecf380ad1d951af9d26ba88c922891.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1670914114481-5eec7eb5-5762-4fc7-8b45-bf5e573e0405.jpeg#averageHue=%23efefef&clientId=u4b755130-ef81-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=311&id=u6fa9b211&margin=%5Bobject%20Object%5D&name=4ecf380ad1d951af9d26ba88c922891.jpg&originHeight=1544&originWidth=1280&originalType=binary&ratio=1&rotation=0&showTitle=false&size=364086&status=done&style=shadow&taskId=ude42b972-f046-4344-bb99-2d90a1c3be5&title=&width=257.73077392578125)
##### 双译码
![1e20befd85b6f6a5d2cd390a89502a2.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1670914151696-39e2a5d3-161e-49c7-9d67-5919555ad2cd.jpeg#averageHue=%23f1f1f1&clientId=u4b755130-ef81-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=286&id=ua08620d5&margin=%5Bobject%20Object%5D&name=1e20befd85b6f6a5d2cd390a89502a2.jpg&originHeight=1280&originWidth=1850&originalType=binary&ratio=1&rotation=0&showTitle=false&size=361865&status=done&style=shadow&taskId=u4b23a76c-3395-40d2-9237-6a1a768120f&title=&width=412.73077392578125)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670840521436-38a8af09-2eb8-4dd0-a2e4-893d0c3b306d.png#averageHue=%23f2f0f0&clientId=u3f6f33ec-d2e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=480&id=u763c8755&margin=%5Bobject%20Object%5D&name=image.png&originHeight=650&originWidth=1247&originalType=binary&ratio=1&rotation=0&showTitle=true&size=286550&status=done&style=shadow&taskId=u819c7f1d-d073-40f5-983a-0caa407750f&title=%E5%9C%B0%E5%9D%80%E7%BA%BF%E5%A4%8D%E7%94%A8%E6%8A%80%E6%9C%AF&width=920.8615654831392 "地址线复用技术")
地址线复用技术，分两次传输地址码，先传行地址码，后传列地址码。
![356562e2de3964179013a6574b194f5.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1670914212480-0a7406dd-dcf5-4af4-a911-39bf0d2d445c.jpeg#averageHue=%23e1e1e1&clientId=u4b755130-ef81-4&crop=0.0136&crop=0.7361&crop=0.9747&crop=0.9307&from=drop&height=1230&id=u98a4c741&margin=%5Bobject%20Object%5D&name=356562e2de3964179013a6574b194f5.jpg&originHeight=1280&originWidth=1902&originalType=binary&ratio=1&rotation=0&showTitle=true&size=793405&status=done&style=shadow&taskId=uebd8701f-477e-4716-bc14-4a2c1404141&title=%E4%B8%A4%E7%A7%8D%E8%AF%91%E7%A0%81%E6%96%B9%E5%BC%8F%E7%9A%84%E6%AF%94%E8%BE%83&width=1828 "两种译码方式的比较")

![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670840641563-63b06a25-f098-4957-9c9a-d87ae85e62ea.png#averageHue=%23ebe1de&clientId=u3f6f33ec-d2e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=521&id=u741162ea&margin=%5Bobject%20Object%5D&name=image.png&originHeight=706&originWidth=1252&originalType=binary&ratio=1&rotation=0&showTitle=false&size=516936&status=done&style=shadow&taskId=ucd6a1602-afb8-4324-9aa1-04fe7e537d4&title=&width=924.5538732837933)

## 主存储器的连接与控制
存储芯片容量有限，主存储器由若干个芯片构成。而且连接起来的芯片需要与cpu连接，才能在CPU的控制下进行读写操作。
![cc36b50df0939ea7602313128573519.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896866825-78298a8f-a859-48f0-ba3f-7c796148f900.png#averageHue=%23f6f7f4&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=467&id=uee402f01&margin=%5Bobject%20Object%5D&name=cc36b50df0939ea7602313128573519.png&originHeight=633&originWidth=1103&originalType=binary&ratio=1&rotation=0&showTitle=true&size=141368&status=done&style=shadow&taskId=u8bd6049f-060f-406e-b09d-d64814f5852&title=cpu%E4%B8%8E%E5%AD%98%E5%82%A8%E5%99%A8%E8%BF%9E%E6%8E%A5%E7%BB%93%E6%9E%84&width=814.5231008243004 "cpu与存储器连接结构")
### 主存容量的拓展
总片数=总容量/容量(每片)
拓展方法有字拓展，位拓展，字位同时拓展
#### 位拓展
只在位的方向上拓展也就是，将各存储器的片选线，地址线，读写线连接起来，然后数据线单独列出来。
![8721bc7419f59135d89e0b964394213.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670897024158-722dd24e-ed5b-4eee-be96-b7f5a115891b.png#averageHue=%23f2f1f1&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u81c50178&margin=%5Bobject%20Object%5D&name=8721bc7419f59135d89e0b964394213.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=510593&status=done&style=shadow&taskId=u22a55c6a-73ad-4da4-9777-9af86742dec&title=&width=1417.8461954511847)

![8557344cdab1216f84e34a268a7309e.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670897072848-5fa54c5c-1d86-4040-b431-3bec6c339581.png#averageHue=%23f0f0e4&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ub2a5303f&margin=%5Bobject%20Object%5D&name=8557344cdab1216f84e34a268a7309e.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=568132&status=done&style=shadow&taskId=u6b5c71c5-344a-4b72-8c0c-79a1c3671b0&title=&width=1417.8461954511847)
如：64K*1的sram芯片组成64K*8的存储器需要8片
其中每一片是主存储器的一位，读取数据的时候，他们同时接收到cpu的地址，然后每个片里面选择相同的存储单元，取数；
#### 字拓展
每个芯片的字长和主存储器的字长相同，在字数上进行拓展。地址线和位拓展一样并联，数据线并联，读写线并联，然后需要通过片选线来选择操作的存储单元。
如：16K*8的sram组成64k*8的存储器的需要4片
(64K*8)/(16K*8)=4
![8ec266ee37316322921ae52b0d88b7a.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670893624071-a36dd5ea-e6a0-4b16-b3bc-2ced08809981.png#averageHue=%23f0e2d9&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ud9789832&margin=%5Bobject%20Object%5D&name=8ec266ee37316322921ae52b0d88b7a.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=848347&status=done&style=shadow&taskId=u66859226-55b1-449d-8552-c7770d093c5&title=&width=1417.8461954511847)
图中的存储单元8k*8bit，两个通过字拓展可以组成16k*8bit的主存，其中8k=213需要至少13条地址线，A0~A12一共13条地址线，接下来就是如何选择对应的存储单元了。
可以直接通过一个地址线去选择，如A13为高电平时候选择左边的存储单元，A14为高电平选择右边的，这样虽然直接方便，但是N个存储单元就需要n个地址线，设计不合理。
增加一个译码器，如1-2译码器，只需要一个地址线就可以选择不同的存储单元。上图中的cpu还有A13A14A15三条多余的地址线，使用译码器的话可以有选择23个存储单元。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670894359506-f3bad6c0-3f7f-403f-aaf9-e435dd9ab5d1.png#averageHue=%23f9f8f8&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=283&id=u44b83c40&margin=%5Bobject%20Object%5D&name=image.png&originHeight=383&originWidth=500&originalType=binary&ratio=1&rotation=0&showTitle=true&size=14924&status=done&style=shadow&taskId=u55562f3c-b46b-4221-b979-54eb9e81c96&title=1-2%E8%AF%91%E7%A0%81%E5%99%A8&width=369.23078006541266 "1-2译码器")
然后是地址的分配
对于第一种线选法
![a76b130684a535bf8c8fa653a381e4e.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670895840156-d820bf6a-8032-4a08-9b8a-781e72c8f7c2.png#averageHue=%239bb735&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u760a6dbe&margin=%5Bobject%20Object%5D&name=a76b130684a535bf8c8fa653a381e4e.png&originHeight=183&originWidth=606&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7640&status=done&style=shadow&taskId=ub050e981-bdd7-4c38-b25d-a6de67dc1ca&title=)
可以看出内存地址分配上的不连续，对内存地址有浪费。
而采用译码器![02f29b511df3a8ac08b9e06a1dbabf2.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896066457-830256be-27de-4461-87c7-d822d40af921.png#averageHue=%2396bb36&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u017d5760&margin=%5Bobject%20Object%5D&name=02f29b511df3a8ac08b9e06a1dbabf2.png&originHeight=183&originWidth=1537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9191&status=done&style=shadow&taskId=u97eeac88-0fac-4e5d-8317-b267786bf98&title=)
地址从全0到全1,内存地址分配上是连续的。
![f73a91316547c79c0d76c3605cbd246.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896141930-319bd01a-7039-40fa-85ee-4a2e029e1c0b.png#averageHue=%23eee4dc&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=uce4deeda&margin=%5Bobject%20Object%5D&name=f73a91316547c79c0d76c3605cbd246.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=true&size=747671&status=done&style=shadow&taskId=u38dd6b4e-7a03-4b96-afd0-8895953af55&title=%E5%AD%97%E6%8B%93%E5%B1%95%E5%9B%9B%E7%89%87%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87%E7%9A%84%E7%BB%93%E6%9E%84&width=1417.8461954511847 "字拓展四片存储芯片的结构")
![310d25dd5583fae4c382232d977a8ca.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896193603-e3eb5ca2-8194-4fb4-b81e-10f50d4bf7a9.png#averageHue=%23f3f2f2&clientId=u24c759c1-b7b9-4&crop=0.1606&crop=0.204&crop=0.8317&crop=0.4398&from=paste&height=536&id=u684860cf&margin=%5Bobject%20Object%5D&name=310d25dd5583fae4c382232d977a8ca.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=441813&status=done&style=shadow&taskId=uc10a7511-0af0-4846-a1db-cd2b9d4f7b4&title=&width=952)
译码器
![2022-12-12 21 49 30.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896370859-b4bb5c69-c239-44f6-b241-29d28749e93e.png#averageHue=%23edecec&clientId=u24c759c1-b7b9-4&crop=0.2998&crop=0.1061&crop=1&crop=0.8667&from=paste&height=559&id=u0a4fa4a6&margin=%5Bobject%20Object%5D&name=2022-12-12%2021%2049%2030.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=772028&status=done&style=shadow&taskId=u13667770-ca4e-4826-b66e-5642fd86bfc&title=&width=993)
cpu先发出地址信号，等待信号稳定后，向译码器发送使能信号，选择使用的芯片进行操作。

#### 字拓展与位拓展同时拓展

![881d127f170d9769a728e9168cbbb83.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670896657015-34f5ad14-b06b-450f-95bc-f18aef98d98b.png#averageHue=%23e0eeda&clientId=u24c759c1-b7b9-4&crop=0.1484&crop=0.1768&crop=0.7721&crop=0.7743&from=paste&height=497&id=u4144cee8&margin=%5Bobject%20Object%5D&name=881d127f170d9769a728e9168cbbb83.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1991330&status=done&style=shadow&taskId=uf0758c87-5b6d-4f60-bd7e-18ce2735871&title=&width=884)
如：16K*4的芯片组成64k*8的存储器
需要8片横向上两片，纵向上4片
### 主存储器和cpu的连接
#### 主存和cpu的硬连接
主存和cpu的三组连线：地址总线(AB)，数据总线(AB)，控制总线(CB)
![主存和cpu的硬连接.drawio.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670915463484-7ba2cc8d-bfd7-47e3-85fc-ce1390fd6eb7.png#averageHue=%23a5a5a5&clientId=u4b755130-ef81-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=ud3b07818&margin=%5Bobject%20Object%5D&name=%E4%B8%BB%E5%AD%98%E5%92%8Ccpu%E7%9A%84%E7%A1%AC%E8%BF%9E%E6%8E%A5.drawio.png&originHeight=262&originWidth=392&originalType=binary&ratio=1&rotation=0&showTitle=true&size=29285&status=done&style=shadow&taskId=u7612b03e-6beb-476c-b384-fc15e00e5cd&title=%E4%B8%BB%E5%AD%98%E4%B8%8ECPU%E7%9A%84%E7%A1%AC%E8%BF%9E%E6%8E%A5 "主存与CPU的硬连接")
MAR接收来自pc的指令地址或者地址形成部件的操作数地址，已确定要访问的单元。
MDR是向主存写入数据或者读入数据的缓冲部件。
MFC为工作完成信号
#### 主存和cpu的软连接
硬连接是物理基础连接，还需要软连接即cpu向主存发送读或者写命令，这是两个部件有效工作的关键。
CPU对主存进行读写操作时，首先在地址总线给出地址信号，然后发送相应的读写命令并在数据总线上交换信息。
![411f94e7dd5896be28e4018083a1f42.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1670916367378-d6dfa975-e6b0-4fa3-b1e9-a2533380f771.jpeg#averageHue=%23e7e7e7&clientId=u4b755130-ef81-4&crop=0&crop=0&crop=1&crop=1&from=drop&id=u21b2297b&margin=%5Bobject%20Object%5D&name=411f94e7dd5896be28e4018083a1f42.jpg&originHeight=1769&originWidth=3812&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3937946&status=done&style=shadow&taskId=u39e3dafd-7654-4232-a811-bca846370e1&title=)
M(MAR)是地址寄存器给的地址中的数据
##### 异步读取的方式
MFC是工作完成信号
CPU与主存之间速度不匹配没有统一的时钟信号，由MFC通知cpu工作完成
##### 同步的读取方式
CPU与主存采用统一的时钟信号，cpu与主存配合，不需要主存工作完成信号
### 主存的校验
无奇偶校验
奇偶校验
错误校验与纠正(ECC)

### 本节回顾
![2022-12-12 21 42 24.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670897107404-eae00de8-104f-4451-b2a5-b8cce0066dd1.png#averageHue=%23f0f0ef&clientId=u24c759c1-b7b9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=524&id=u54464178&margin=%5Bobject%20Object%5D&name=2022-12-12%2021%2042%2024.png&originHeight=709&originWidth=1256&originalType=binary&ratio=1&rotation=0&showTitle=false&size=224006&status=done&style=shadow&taskId=ub373c8ba-2ffe-4e54-adf9-e5f5e5f07eb&title=&width=927.5077195243166)
## 提高主存读写速度的技术
### 双端口RAM
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670990062812-157dee84-d222-4814-b018-45b4afc92503.png#averageHue=%23ececec&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=160&id=u3ed4e2c4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=216&originWidth=432&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25028&status=done&style=shadow&taskId=u40bff7ba-f2ee-459f-b7ab-7c22b96445e&title=&width=319.0153939765165)
即主存与cpu之间有多条数据线连接，优化了多核cpu访问同一根内存条的速度。
需要两组完全独立的数据线，地址线，控制线。cpu，ram中也要有更复杂的控制电路
两个端口对同一个主存操作的情况：

1. 两个端口同时对不同的地址单元存取数据。		没问题
2. 两个端口同时对同一地址单元读取数据。			没问题
3. 两个端口同时对同一地址单元写入数据。			写入错误
4. 两个端口同时对同一地址单元，一个读入，一个写入。	读出错误

为了解决这个问题可以添加一个标志位，但这个标志位置0则暂时关闭一个端口，未被关闭的端口正常工作，被关闭的阻塞等待。

### 多模块存储器
#### 单体多字存储器
每次并行的读取m个连续的字
总线宽度也要拓展为m个字
#### 多体并行存储器
##### 高位交叉编址
数据顺序存储在物理地址上也是连续的，在访问一次后需要等待恢复时间，才能继续下次的访问。
##### 低位交叉编址
数据在物理地址上是不连续的，分在不同的存储芯片上，每次访问后下次访问的数据在下一个存储芯片不需要等待就可以访问下个数据，等待数据恢复好，就能开始下次的访问。
![2022-12-13 16 04 54.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670991391393-8f1c5881-d703-44ff-9838-c0afb396acae.png#averageHue=%23e5e5e5&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=576&id=u4986e13e&margin=%5Bobject%20Object%5D&name=2022-12-13%2016%2004%2054.png&originHeight=780&originWidth=1380&originalType=binary&ratio=1&rotation=0&showTitle=false&size=564508&status=done&style=shadow&taskId=uc4724899-8eed-4ca0-875a-4e3ef19acdf&title=&width=1019.076952980539)
存取时间r 存取周期t 假设t=4r，则需要t+4r就可以
![2022-12-13 16 25 54.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670991500750-41f06252-c99b-4733-b0ef-12cd39e4c67e.png#averageHue=%23e6e5e4&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=576&id=ue6e327e4&margin=%5Bobject%20Object%5D&name=2022-12-13%2016%2025%2054.png&originHeight=780&originWidth=1380&originalType=binary&ratio=1&rotation=0&showTitle=false&size=644354&status=done&style=shadow&taskId=ub047f339-2732-4fdc-bde3-af6b83d056d&title=&width=1019.076952980539)
![2022-12-13 16 34 29.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670991806199-4f3b81d7-8f53-41f8-8b7f-6a3633539b39.png#averageHue=%2379897d&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=576&id=u525d4ac2&margin=%5Bobject%20Object%5D&name=2022-12-13%2016%2034%2029.png&originHeight=780&originWidth=1380&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1047853&status=done&style=shadow&taskId=u23579969-0bfb-483a-b324-7ae1819b9a0&title=&width=1019.076952980539)
![2022-12-13 16 30 04.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670991827986-cc96ac13-8351-4dc1-bd1c-c2d43326b9d4.png#averageHue=%23e9e9e9&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=576&id=u115bba1a&margin=%5Bobject%20Object%5D&name=2022-12-13%2016%2030%2004.png&originHeight=780&originWidth=1380&originalType=binary&ratio=1&rotation=0&showTitle=false&size=415251&status=done&style=shadow&taskId=ud6f6ba5b-786b-45d6-bc3d-22703572403&title=&width=1019.076952980539)



## 多体交叉存储技术
## 固态硬盘SSD
![2022-12-14 09 19 13.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1670991782446-fcf9f17c-ba57-4f24-b6aa-4b529b1bee9a.png#averageHue=%23e1e1e1&clientId=u1023b0f1-fda1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u4e9ee9ae&margin=%5Bobject%20Object%5D&name=2022-12-14%2009%2019%2013.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=867323&status=done&style=shadow&taskId=u2e6ef93f-ed4d-4224-9f45-42a467d4650&title=&width=1417.8461954511847)




## 高速缓冲存储器
### cache基本原理
#### 局部性原理
时间局部性
现在访问的数据在未来的一段时间内很可能也会被访问
空间局部性
在未来要用到的信息很可能与现在在用的信息在存储空间上是邻近的
### 性能分析
假设cache的命中率95%，速度是主存的5倍，假设主存和cache同时访问，则使用cache后性能的提升多少。
h=95%
cache的存取周期为t，主存5t
T=0.95*t+(1-0.95)*5t=1.2t
性能提升了5t/1.2t倍
若先访问cache然后才主存
T=0.95*t+(1-0.95)*6t
![2022-12-14 09 44 42.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671021741406-b1dd1779-9ea1-4977-adf3-190c3dc7296f.png#averageHue=%23ededed&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u0024f375&margin=%5Bobject%20Object%5D&name=2022-12-14%2009%2044%2042.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=572776&status=done&style=shadow&taskId=u9c5ad303-0008-4e0b-902d-13ca99b58c1&title=&width=1417.8461954511847)
### cache和主存的映射方式
首先cache和主存是分块的cache中的块和主存中的块大小相等，不过cache中的容量大小要小的多。对每个cache块都有一个标志位，来标志这个块是否有效。如果不设置的话默认初始化为0，不能正确表达映射。还有多位的标志位用来标志这个cache所映射的地址。
#### 全相连映射
全相连映射即随便映射，主存中的数据块可以在cache中随意的存放。
![2022-12-14 10 00 51.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022121334-1dbfe533-9017-4e48-b593-17ac989a1d34.png#averageHue=%23ecebeb&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=uac511611&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2000%2051.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=822207&status=done&style=shadow&taskId=u17403779-0b50-4584-a1a7-2e78fd16102&title=&width=1417.8461954511847)
关于访存，计算机会访问cache的标志位，若与要访问的地址匹配则命中。
![2022-12-14 10 03 55.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022143955-af4fcfe4-91b9-4da9-9ee8-45ee14e15763.png#averageHue=%23e9e9e8&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u0c7ce0b7&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2003%2055.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=951066&status=done&style=shadow&taskId=u6736f811-1f47-4909-83ee-70a69a998f4&title=&width=1417.8461954511847)

#### 直接映射
直接映射
![2022-12-14 10 07 05.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022156174-7a1779ec-7ad6-4c83-aa98-a2900d366318.png#averageHue=%23e8e4d9&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u4e285f65&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2007%2005.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1024269&status=done&style=shadow&taskId=ud21e3c41-34db-472d-9811-4b99039794d&title=&width=1417.8461954511847)
主存中的块会被存放到指定的cache块中，主存块对cache的块数量取mod即可得到。
因为是取模所以相当于取地址码的最后几位即可。所需要的地址标志位少。

#### 组相连映射
![2022-12-14 10 11 21.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022198595-87cbd4b7-47d4-4923-8a8a-689e2377301a.png#averageHue=%23e3e0d9&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u68c4798f&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2011%2021.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1118364&status=done&style=shadow&taskId=u3084b323-cfde-4c1c-b7b3-b0dea0535db&title=&width=1417.8461954511847)
对cache进行分组主存对cache的组进行取模来得到分配的指定小组，这些主存块只能分配到这个小组内，不过在小组内采用全相联映射。因为对有指定的cache小组块所以需要记录的标志根据cache的小组数量i可以少log2i

![2022-12-14 09 53 28.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022058602-9b400035-9457-4a9e-967f-f04fdd3989ca.png#averageHue=%23e8e7e7&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u5937f6b2&margin=%5Bobject%20Object%5D&name=2022-12-14%2009%2053%2028.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=738494&status=done&style=shadow&taskId=u3e008c5f-8348-42e0-a814-f56ff5db5ef&title=&width=1417.8461954511847)
![2022-12-14 10 11 08.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022181872-d3f62b43-ec61-4de0-a8f8-f97781cc400f.png#averageHue=%23e8e8e8&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ua4387e74&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2011%2008.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=783120&status=done&style=shadow&taskId=u03999ae5-80d5-449f-875f-ac316a831d2&title=&width=1417.8461954511847)

### cache的替换算法
在采用组相联和全相联，主存往cache块中送数据块的时候cache满了，这时候就需要替换算法。
#### 随机算法
![2022-12-14 10 16 55.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022432481-9bcf4f75-38d2-4519-9063-3007d06fd923.png#averageHue=%23e7e5cb&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u22cb0c78&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2016%2055.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=614920&status=done&style=shadow&taskId=u439404ee-eb83-4255-99a6-03e14d55ce6&title=&width=1417.8461954511847)
不管过去未来是否使用直接替换一个随机的块。
#### 先进先出
![2022-12-14 10 18 29.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022395846-8ebe678f-a188-4d35-acb6-bbffd09d311b.png#averageHue=%23e6e4c9&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ue2273df5&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2018%2029.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=690789&status=done&style=shadow&taskId=u27715317-b9df-4e9f-b512-f2ff28d5513&title=&width=1417.8461954511847)
![2022-12-14 10 19 56.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022403335-2b195d7f-1202-40d3-b681-8ff1e87fcad6.png#averageHue=%23e1e0ab&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ue59c5595&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2019%2056.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=804510&status=done&style=shadow&taskId=u59b38ac7-aa9c-4de6-8c03-bfde094b241&title=&width=1417.8461954511847)
根据先进先出的队列，将最早进入的cache块替换掉。
#### 最近最少使用
![2022-12-14 10 22 59.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022411710-c2878811-f91f-4f67-966c-042af0286051.png#averageHue=%23d5d57d&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ub3309d32&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2022%2059.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=754987&status=done&style=shadow&taskId=ua5181e8e-87ff-4816-b519-41117158901&title=&width=1417.8461954511847)
使用计数器记录当cache被使用后计数器清0，否则+1，最大不超过cache中数据块的数量。
当有新的数据需要替换则替换计数器最大的那块。
#### 最不经常使用
对经常使用的块的计数器+1，没次替换掉较小的，如果这段时间在刷抖音，则抖音的块计数器的数值很高短时间下不来，为后续其他应用的使用很不方便。![2022-12-14 10 32 46.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022419298-7ee5fcbd-89cf-4c69-ae49-636dbd035080.png#averageHue=%23e2dfdf&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u41b839fa&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2032%2046.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=534600&status=done&style=shadow&taskId=ubfc462d7-298c-47ed-aaa3-c9f57591db9&title=&width=1417.8461954511847)
### cache的写策略

![2022-12-14 10 40 47.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022454042-dba38946-45b5-49c4-8af0-3bedbd2b99a3.png#averageHue=%23eaeaea&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=301&id=u63e3894b&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2040%2047.png&originHeight=407&originWidth=720&originalType=binary&ratio=1&rotation=0&showTitle=false&size=112329&status=done&style=shadow&taskId=u474a5c58-b262-4b2c-a8a7-06a215e33cf&title=&width=531.6923232941942)
#### 写命中
全写法：对cache命中时在cache和主存中全部更新数据，并且在写入主存时使用写缓冲，把数据块写入缓冲队列中，缓冲块速度相对主存要快。当缓冲块满了之后需要cpu阻塞等待缓冲区的写入。
写回法：cache命中之后只写入cache，只有当这块被替换的时候才写回去主存。对于写回法需要一个脏位的标志位来表明数据被修改过。
![2022-12-14 10 37 24.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022587499-8fe69f83-8a26-4ef0-b473-5a9224e813f5.png#averageHue=%23ebe9e8&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u0a8c5666&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2037%2024.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=664807&status=done&style=shadow&taskId=ua7cb51a9-e031-40c1-9bdb-5fb778ea546&title=&width=1417.8461954511847)

![2022-12-14 10 35 40.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022576717-2ef8b9f3-359f-4386-ac59-508af7de712a.png#averageHue=%23eae7e6&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=ub90ffc2f&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2035%2040.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=708881&status=done&style=shadow&taskId=udf181796-4581-499d-b3de-272e52489e2&title=&width=1417.8461954511847)

![2022-12-14 10 37 52.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022537125-17229ff3-2650-4b9a-a966-d0244f558790.png#averageHue=%23e9e7e6&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u6b5b8d75&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2037%2052.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=757679&status=done&style=shadow&taskId=uad94c6ed-10a9-46b0-a3d1-a993438076d&title=&width=1417.8461954511847)

#### 写不命中
非写分配法：当CPU对cache不命中时候只写入主存不调入cache
写分配法：写入主存还读入cache
![2022-12-14 10 38 58.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022530365-b18257e5-8d20-4b06-a03b-0220cb00b7e4.png#averageHue=%23ebeae9&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=0.8776&from=paste&height=798&id=u2895c86d&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2038%2058.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=655953&status=done&style=shadow&taskId=u2ebe2d81-6fba-4a72-bed6-a5c5c3f4f97&title=&width=1418)
### 多级缓冲

![2022-12-14 10 40 04.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022595152-96eb98b5-c072-40c0-9bb0-4739e827137c.png#averageHue=%23d3d2d1&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u0cb5affa&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2040%2004.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=644382&status=done&style=shadow&taskId=uc2d19840-38c7-482d-b8ba-ee0ef778526&title=&width=1417.8461954511847)
## 虚拟存储器
虚拟存储器由主存和磁盘存储器组成。这两个存储器在硬件和操作系统的联合下完成工作。
同cache和主存一样对磁盘存储器分页，在需要的时候将数据从磁盘加载到主存当中。

虚拟存储器将主存或辅存的地址空间统一编址,形成一个庞大的存储空间。在这个大空间里,用户可以自由编程,完全不必考虑程序在主存是否装得下以及这些程序将来在主存中的实际存放位置。
用户编程的地址称为虚地址或逻辑地址,实际的主存单元地址称为实地址或物理地址,显然,虚地址要比实地址大得多。
在实际的物理存储层次上,所编程序和数据在操作系统管理下,先送入磁盘,然后操作系统将当前运行所需要的部分调人主存,供 CPU 使用,其余暂不运行部分留在磁盘中。
程序运行时,CPU 以虚地址来访问主存,由辅助硬件找出虚地址和实地址之间的对应关系,并判断这个虚地址指示的存储单元内容是否已装人主存。如果已在主存中,则通过地址变换，CPU 可直接访问主存的实际单元;如果不在主存中,则把包含这个字的一页或一个程序段调人主存后再由 CPU 访问。如果主存已满，则由替换算法从主存中将暂不运行的-页或一段调回辅存,再从辅存调人新的一页或一段到主存。从原理的角度看,虚拟存储器和 Cache-主存有不少相同之处。事实上,前面提到的各种方法是先应用于虚拟存储器中后来才发展到 Cache-主存层次中的。
### 页式存储
页表
![75503b93ec8e29a22136244b2f5a6f9.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1671082763884-efc8d387-8703-44e5-997a-7d7226b2fa49.jpeg#averageHue=%23e6e6e6&clientId=uf565cf03-2fc5-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=611&id=u3928a025&margin=%5Bobject%20Object%5D&name=75503b93ec8e29a22136244b2f5a6f9.jpg&originHeight=1564&originWidth=1280&originalType=binary&ratio=1&rotation=90&showTitle=false&size=560219&status=done&style=none&taskId=udd6f59a6-6f98-4216-b60f-3b8cbf8fd66&title=&width=499.67694091796875)
![2022-12-14 10 49 28.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022608065-66e83f89-d83c-498b-b404-e3c5e0c16bf1.png#averageHue=%23ece7e6&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u9cc5a594&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2049%2028.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=583989&status=done&style=shadow&taskId=u49be1cd1-ab1c-49da-9bee-74621512583&title=&width=1417.8461954511847)
![2022-12-14 10 54 50.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022614641-b87423e3-e2fd-47e2-b1fa-0f358e780bd0.png#averageHue=%23e9e5e4&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u7c116a6f&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2054%2050.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=686735&status=done&style=shadow&taskId=uc28ebb3c-5558-429a-896c-9813453ac67&title=&width=1417.8461954511847)
![2022-12-14 10 57 54.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022619926-7b862abd-6d44-47cf-8bf9-aed76c858087.png#averageHue=%23ebe9e7&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=uf00b7a73&margin=%5Bobject%20Object%5D&name=2022-12-14%2010%2057%2054.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=744614&status=done&style=shadow&taskId=u0dabc67b-ade5-4d01-92f5-d9af80f3349&title=&width=1417.8461954511847)
![2022-12-14 11 01 39.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022625276-3c48590b-c7b6-48ea-bdba-d1e98911fde2.png#averageHue=%23eceae7&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u0ccc535b&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2001%2039.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=665284&status=done&style=shadow&taskId=u6f343dce-49d1-4ad0-a6bf-587c5f7ba51&title=&width=1417.8461954511847)
![2022-12-14 11 02 04.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022630272-3a074d42-1f44-441e-8213-8a3186495a8f.png#averageHue=%23ebe7df&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u9b3497c9&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2002%2004.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=777004&status=done&style=shadow&taskId=ue06c216e-8495-4366-8fcd-58e60341588&title=&width=1417.8461954511847)
![2022-12-14 11 03 41.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022636206-432e458f-c1f6-4712-b015-06244388a2f8.png#averageHue=%23eae7de&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u50bceef0&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2003%2041.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=819812&status=done&style=shadow&taskId=u1b37b3bb-98c5-4eff-b086-227f595f975&title=&width=1417.8461954511847)
![2022-12-14 11 04 34.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022641508-735a9e89-b612-4337-8efd-ccfd5c134238.png#averageHue=%23f2f0ef&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u9c88909f&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2004%2034.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=592589&status=done&style=shadow&taskId=uc3ae885a-ba9a-467b-a45f-03f6ed0662f&title=&width=1417.8461954511847)
![2022-12-14 11 07 13.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022647103-eabe16b3-3406-44c8-849c-e74ff307c301.png#averageHue=%23ebe7e1&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=798&id=u5c6830ec&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2007%2013.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1033429&status=done&style=shadow&taskId=u2aa6f2f6-3983-40cc-b70f-7e8002818e3&title=&width=1417.8461954511847)
![2022-12-14 11 11 43.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022653928-483a6452-f731-4ea6-acc4-19c90f6ad3d8.png#averageHue=%23afaead&clientId=ud7de39bb-26e9-4&crop=0.1453&crop=0.0626&crop=0.6757&crop=0.5785&from=paste&height=423&id=u64946b63&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2011%2043.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=829624&status=done&style=shadow&taskId=u61a65403-1c5d-451a-9384-accb6c97d48&title=&width=752)
![2022-12-14 11 14 19.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022671809-e7cd90f6-3d14-4359-9090-40c829529bf5.png#averageHue=%23868482&clientId=ud7de39bb-26e9-4&crop=0.1419&crop=0.066&crop=0.6806&crop=0.61&from=paste&height=363&id=u626c2495&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2014%2019.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1492413&status=done&style=shadow&taskId=u72354868-b245-488f-9606-68e6575fc96&title=&width=644.9923095703125)
![2022-12-14 11 14 37.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671022678838-f787410b-6909-4b0d-b148-df6bbffea9c1.png#averageHue=%23e8e3e2&clientId=ud7de39bb-26e9-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=431&id=u6da600f8&margin=%5Bobject%20Object%5D&name=2022-12-14%2011%2014%2037.png&originHeight=583&originWidth=1032&originalType=binary&ratio=1&rotation=0&showTitle=false&size=223798&status=done&style=shadow&taskId=u0f69980b-8a71-4da6-a7c7-c938d95edfe&title=&width=762.0923300550118)
页表是慢表，存在着cache和主存一样的关系的快表。
### 段式存储
同分页一样，只不过他是按程序段划分。大小参差不齐
### 段页式存储

# 中央处理器
## 概念
中央处理器由控制器和运算器组成，是整个计算机的核心所在。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/23135285/1671087529901-3b9a976a-2af5-4c9e-8644-5394008d324c.png#averageHue=%231b1b1b&clientId=uf565cf03-2fc5-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=665&id=uabb14610&margin=%5Bobject%20Object%5D&name=image.png&originHeight=900&originWidth=972&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23077&status=done&style=none&taskId=u67be6af6-03e6-4b7e-a534-6be18abbc40&title=&width=717.7846364471623)
控制器的主要功能如下 ：
1. 从主存中取出一条指令,并指出下一条指令在主存中的位置
2. 对指令进行译码或测试,产生相应的操作控制信号，以便启动规定的动作.
3. 指挥并控制 CPU主存和输人输出设备之间的数据流动方向。
运算器的主要功能如下：
1. 执行所有的算术运算。
2. 执行所有的逻辑运算，并进行逻辑测试。

![9bb3489df9e6f00bf1e1fa2764a0a00.jpg](https://cdn.nlark.com/yuque/0/2022/jpeg/23135285/1671083834847-ae030b1f-c6a7-4c5d-8509-5a22d0612ac7.jpeg#averageHue=%2376716c&clientId=uf565cf03-2fc5-4&crop=0&crop=0.1855&crop=1&crop=0.7614&from=drop&height=1280&id=u74a41fab&margin=%5Bobject%20Object%5D&name=9bb3489df9e6f00bf1e1fa2764a0a00.jpg&originHeight=1280&originWidth=1706&originalType=binary&ratio=1&rotation=0&showTitle=false&size=556039&status=done&style=none&taskId=u6f890811-1bea-43da-be90-58a6051403f&title=&width=1706)
![[cpu的内部结构.png]]
## 运算器和控制器
### 运算器的基本组成
![[运算器的组成.png]]
###  控制器的基本组成
![[控制器的组成.png]]
### 控制器的基本结构
![[控制器的基本结构.png]]
### 运算器和控制器的功能
![[运算器和控制器的功能.png]]
### cpu 单总线结构
![[cpu单总线结构.png]]
要在各个寄存器中传递数据，只需要用 cu 控制个寄存器或者其他单元的控制信号，
如 pc->mar
Cu 给 pc 的读控制线一个信号，mar 的输入控制线一个信号这样数据就会通过总线传递。
Alu 逻辑运算单元，只能同时输入才能有效。所以信号不可以分两次送进 alu，这时候就需要 acc 累加寄存器，提前将一个数加载到 acc 中这样就可以和输入数据同时进入 alu。
## 指令执行的过程
### 指令周期
指令周期：CPU从主存中取出并执行一条指令所需的全部时间。
![[指令周期.png]] 
指令周期常用若干个机器周期表示，机器周期又叫CPU周期。
一个机器周期又分为若干个时钟周期。
**时钟周期**又叫CPU时钟周期，是CPU操作的最基本单位。
计算机的主频3.0GHz说的是一秒钟计算机可以有3.0G个时钟周期。
![[指令周期-机器周期-时钟周期.png]]
一些指令的周期
![[一些指令的周期.png]]
一般一个指令周期的最后会有中断周期，这段时间内会检测来自外部的中断信息，如果有中断信号，则将当前pc保存到堆栈寄存器当中（记得sp-1），保存当前状态。等待中断信号处理后恢复运行。
### 指令周期的流程控制
![[指令周期的流程控制.png]]
对应四个周期存在四个触发器，指定触发器置1表示这个指令周期正处于这个状态
![[指令周期的触发器.png]]
### 取指周期
![[取指周期.png]]
### 间指周期

### 中断周期
![[中断周期.png]]
### 执行周期

### 指令执行的方案
![[指令执行的方案.png]]
### 小节回顾
![[指令周期的小节回顾.png]]

##  硬布线控制器
### Cu 控制单元结构
![[硬布线控制器.png]]
Cu 控制单元接收指令寄存器过来的经过译码器的指令。
操作码译码器类似地址译码器，将输入的指令转为合适的输出，一个指令对应一条输出。操作码有 n 位译码器就有 2<sup>n</sup> 个输出
节拍发生器接收时钟信号，有 n 个输出表示一个指令周期分为 N 个时钟周期，一般这个长度由操作时间最长的访问主存单元的时间确定。
Cu 内部集成四个触发器，用来表示指令执行的第几个周期
Cu 接收其他部分的单元的反馈信息
Cu 根据上面输入的不同的信号，输出 n 个控制信号表示有 N 个位操作
![[微指令的线路的设计.png]]
设计指令的时候，考虑把前后不依靠不冲突的指令设计在一个周期

### 硬布线控制器的设计
设计步骤：
1. 分析每个阶段的微操作序列（取址，间址，执行，中断）在指令的不同阶段有哪些微操作
2. 选择 cpu 的控制方式 （定长机器周期和不定长机器周期）这里一个机器周期安排 3 个节拍信号，即 3 个时钟信号
3. 安排微操作时序，将机器周期的微操作序列用 3 个时钟信号完成
4. 电路的设计，确定每个微操作的逻辑表达式并用电路实现
取值周期：（大多数的微操作的取值周期都是这样）
1. 将要执行的操作的地址从 pc 程序计数器读入 MAR
2. 给主存一个读数据信号
3. 将 MAR 指向的地址从内存单元中读到 MDR 数据寄存器
4. Pc 程序计数器加一
5. 数据寄存器将指令传给 ir 指令寄存器
6. Ir 将指令操作码给指令译码器
间址周期：（指令中的地址是一个间接地址，这时候就需要间接寻址）
1. 指令寄存器中的地址传递给 MAR
2.  给主存一个读数据信号
3. 将 MAR 指向的地址从内存单元中读到 MDR 数据寄存器
4. 将新的数据替换 ir 中的操作数
可以看出上面两个周期都有用到同样的操作，在分析完全部周期后统计制表就可以写出指定操作的逻辑表达式。然后就可以设计电路。
这种硬布线控制器每增加一种指令操作就需要重新设计电路，很是复杂，扩充指令很困难，不过由于由硬件设计执行速度很快。因此常常用在 risc精简指令集。
## 微程序控制器



# 总线
# 外部设备
# 输入输出

